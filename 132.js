"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[132],{7716:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(2983);const o=[];function a(e,t,n=((e,t)=>e===t)){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let o=0;o<r;o++)if(!n(e[o],t[o]))return!1;return!0}const l=(e,t,n)=>function(e,t=null,n=!1,r={}){null===t&&(t=[e]);for(const e of o)if(a(t,e.keys,e.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return r.lifespan&&r.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,r.lifespan)),e.response;if(!n)throw e.promise}const l={keys:t,equal:r.equal,remove:()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1)},promise:(c=e,"object"==typeof c&&"function"==typeof c.then?e:e(...t)).then((e=>{l.response=e,r.lifespan&&r.lifespan>0&&(l.timeout=setTimeout(l.remove,r.lifespan))})).catch((e=>l.error=e))};var c;if(o.push(l),!n)throw l.promise}(e,t,!1,n);var c=n(1906),i=n(4917),s=n(5232),u=n(9097);const f={search:""},p=({search:e,...t})=>JSON.stringify({...t,search:e.toLowerCase().trim()}),m=()=>JSON.parse(p(f));function d({setQueries:e}){const[t,n]=(0,r.useState)(f),o=(0,r.useMemo)((()=>new c.x),[]);return(0,r.useEffect)((()=>{const t=o.pipe((0,i.U)(p),(0,s.x)(),(0,u.b)(400)).subscribe((t=>e((e=>({...e,...JSON.parse(t)})))));return()=>t.unsubscribe()}),[o]),(0,r.useEffect)((()=>{o.next(t)}),[t]),r.createElement("div",null,r.createElement("input",{type:"search",value:t.search,onChange:(0,r.useCallback)((({target:e})=>n((t=>({...t,search:e.value})))),[])}))}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}const h=({title:e,onPress:t,...n})=>r.createElement("button",y({onClick:t},n),e),v=({title:e,onPress:t,...n})=>r.createElement("a",y({href:"#",onClick:t?e=>(e.preventDefault(),t(e)):void 0},n),e),E="div",b="div";function g({uri:e,loop:t,meta:n,onEnded:o}){const[a,l]=(0,r.useState)(!1),c=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=c.current;if(e){const t=e=>(console.log(["onPlay"],e),l(!0)),n=e=>(console.log(["onPause"],e),l(!1));return e.addEventListener("play",t),e.addEventListener("pause",n),e.addEventListener("ended",o),()=>{e.removeEventListener("play",t),e.removeEventListener("pause",n),e.removeEventListener("ended",o)}}}),[c,o]),(0,r.useEffect)((()=>{a&&"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata(n))}),[a,n]),r.createElement(b,null,a?r.createElement(h,{title:"Pause",onPress:async function(){c.current&&c.current.pause()}}):r.createElement(h,{title:"Play",onPress:async function(){c.current&&(await c.current.play(),console.log(["play"]))},disabled:!e}),r.createElement("audio",{ref:c,src:e,loop:t,autoPlay:!0,controls:!0}),r.createElement(h,{title:"Forward",onPress:()=>{const e=c.current;e&&e.duration&&(e.currentTime=e.duration-3)},disabled:!c}))}function w(){return r.createElement(b,null,r.createElement(E,null,"Loading..."))}function O({data:e,expanded:t=!1}){const[n,o]=(0,r.useState)(t);return r.createElement("pre",null,n?JSON.stringify(e,null,2):r.createElement(r.Fragment,null,"[",r.createElement("a",{href:"#",onClick:e=>(e.preventDefault(),o(!0))},"..."),"]"))}const k="";function S({version:e=1}){const[t,n]=(0,r.useState)([]),[o,a]=(0,r.useState)(!1),[c,i]=(0,r.useState)(),[s,u]=(0,r.useState)(),f=l((async()=>(await fetch(`${k?`${k}/`:""}api/audio?${e}`)).json()),[e]),[p,y]=(0,r.useState)((()=>m())),h=(0,r.useCallback)((({target:e})=>{return t=e.value,n((n=>e.checked?n.concat(t):n.filter((e=>e!==t))));var t}),[]),E=(0,r.useMemo)((()=>(f||[]).map((({name:e,...t})=>({...t,name:e,href:`${k}/api/audio/${encodeURIComponent(e)}`})))),[f]),w=(0,r.useCallback)((e=>(({name:e,href:t,title:n,album:r,artists:o,artwork:a})=>(i(t),u(Object.assign(n?{title:n,album:r,artist:o.join(", ")}:{title:e},a&&{artwork:a.map((({src:e,...n})=>({src:new URL(`${t}/${e}`,document.location.origin||"").toString(),...n})))}))))(E.find((t=>t.href===e)))),[E]),S=(0,r.useCallback)((()=>{if(console.log(["onEnded"]),t.length>0){const e=t.indexOf(c)+1;w(e<t.length?t[e]:t[0])}}),[c,t]),j=c,P=(0,r.useMemo)((()=>E.filter((e=>e.name.toLocaleLowerCase().includes(p.search)))),[E,p]);return console.log({filtered:P,list:E,meta:s}),r.createElement(b,null,r.createElement(d,{setQueries:y}),r.createElement("ul",null,P.map((({name:e,href:o,title:a,artists:l,picture:c},i)=>r.createElement("li",{key:i,style:{display:"flex",flexDirection:"row",padding:1,alignItems:"center",background:o===j?"aliceblue":""}},r.createElement("input",{type:"checkbox",value:o,checked:t.includes(o),onChange:h}),c&&c.map(((e,t)=>r.createElement("img",{key:t,src:e,width:"50",height:"50"}))),r.createElement(v,{style:{padding:4},title:a?`${l.join(", ")} - ${a}`:e,onPress:()=>(n([o]),w(o))}))))),r.createElement(g,{uri:c,loop:1===t.length&&t.includes(c),meta:s,onEnded:S}),r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:o,onChange:({target:e})=>a(e.checked)}),r.createElement("span",null,"loop")),r.createElement(O,{data:f}))}function j(){return r.createElement(b,null,r.createElement(E,null,`API_URL: ${k}`),r.createElement(r.Suspense,{fallback:r.createElement(w,null)},r.createElement(S,null)))}},3112:(e,t,n)=>{n.d(t,{CR:()=>c,XA:()=>l,ZT:()=>o,ev:()=>i,pi:()=>a});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return l}function i(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}}]);
//# sourceMappingURL=132.js.map