"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[15],{31015:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(22155);const o=[];function i(e,t,n=((e,t)=>e===t)){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let o=0;o<r;o++)if(!n(e[o],t[o]))return!1;return!0}const l=(e,t,n)=>function(e,t=null,n=!1,r={}){null===t&&(t=[e]);for(const e of o)if(i(t,e.keys,e.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return r.lifespan&&r.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,r.lifespan)),e.response;if(!n)throw e.promise}const l={keys:t,equal:r.equal,remove:()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1)},promise:(s=e,"object"==typeof s&&"function"==typeof s.then?e:e(...t)).then((e=>{l.response=e,r.lifespan&&r.lifespan>0&&(l.timeout=setTimeout(l.remove,r.lifespan))})).catch((e=>l.error=e))};var s;if(o.push(l),!n)throw l.promise}(e,t,!1,n);var s=n(45479),u=n(66548),c=n(42216),a=n(52228);const f={search:""},h=({search:e,...t})=>JSON.stringify({...t,search:e.toLowerCase().trim()}),p=()=>JSON.parse(h(f));function d({setQueries:e}){const[t,n]=(0,r.useState)(f),o=(0,r.useMemo)((()=>new s.B),[]);return(0,r.useEffect)((()=>{const t=o.pipe((0,u.T)(h),(0,c.F)(),(0,a.B)(400)).subscribe((t=>e((e=>({...e,...JSON.parse(t)})))));return()=>t.unsubscribe()}),[o]),(0,r.useEffect)((()=>{o.next(t)}),[t]),r.createElement("div",null,r.createElement("input",{type:"search",value:t.search,onChange:(0,r.useCallback)((({target:e})=>n((t=>({...t,search:e.value})))),[])}))}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(null,arguments)}const y=({title:e,onPress:t,...n})=>r.createElement("button",v({onClick:t},n),e),b=({title:e,onPress:t,...n})=>r.createElement("a",v({href:"#",onClick:t?e=>(e.preventDefault(),t(e)):void 0},n),e),m="div",w="div";function g({uri:e,loop:t,meta:n,onEnded:o}){const[i,l]=(0,r.useState)(!1),s=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=s.current;if(e){const t=e=>(console.log(["onPlay"],e),l(!0)),n=e=>(console.log(["onPause"],e),l(!1));return e.addEventListener("play",t),e.addEventListener("pause",n),e.addEventListener("ended",o),()=>{e.removeEventListener("play",t),e.removeEventListener("pause",n),e.removeEventListener("ended",o)}}}),[s,o]),(0,r.useEffect)((()=>{i&&"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata(n))}),[i,n]),r.createElement(w,null,i?r.createElement(y,{title:"Pause",onPress:async function(){s.current&&s.current.pause()}}):r.createElement(y,{title:"Play",onPress:async function(){s.current&&(await s.current.play(),console.log(["play"]))},disabled:!e}),r.createElement("audio",{ref:s,src:e,loop:t,autoPlay:!0,controls:!0}),r.createElement(y,{title:"Forward",onPress:()=>{const e=s.current;e&&e.duration&&(e.currentTime=e.duration-3)},disabled:!s}))}var E=n(45424),S=n(26634);var x=n(37239);const k=()=>"volume-list";function _(){const[e,t]=(0,r.useState)(NaN);(0,r.useEffect)((()=>{fetch("api/audio/volume").then((e=>e.json())).then((({volume:e})=>e)).then(t)}),[]);const n=(0,r.useMemo)((()=>new s.B),[]);(0,r.useEffect)((()=>{const e=n.pipe((t=1,r=function(e,n){return t<=n},(0,E.N)((function(e,t){var n=0;e.subscribe((0,S._)(t,(function(e){return r.call(void 0,e,n++)&&t.next(e)})))}))),(0,x.M)(console.log),(0,c.F)(),(0,a.B)(400)).subscribe((e=>fetch(`api/audio/volume/${e}`).then((e=>e.json())).then(console.log)));var t,r;return()=>e.unsubscribe()}),[n]),(0,r.useEffect)((()=>{Number.isNaN(e)||n.next(e)}),[e]);const o=(0,r.useCallback)((({target:e})=>t(Number(e.value))),[]),i=k();return r.createElement("div",null,!Number.isNaN(e)&&r.createElement("input",{type:"range",list:i,min:"0",max:"100",value:e,onChange:o}),r.createElement("datalist",{id:i},[...Array(11)].map(((e,t,n)=>r.createElement("option",{key:t,value:100/(n.length-1)*t})))))}function O(){return r.createElement(w,null,r.createElement(m,null,"Loading..."))}function C({data:e,expanded:t=!1}){const[n,o]=(0,r.useState)(t);return r.createElement("pre",null,n?JSON.stringify(e,null,2):r.createElement(r.Fragment,null,"[",r.createElement("a",{href:"#",onClick:e=>(e.preventDefault(),o(!0))},"..."),"]"))}const I="";function P({version:e=1}){const[t,n]=(0,r.useState)([]),[o,i]=(0,r.useState)(!1),[s,u]=(0,r.useState)(),[c,a]=(0,r.useState)(),f=l((async()=>(await fetch(`${I?`${I}/`:""}api/audio?${e}`)).json()),[e]),[h,v]=(0,r.useState)((()=>p())),y=(0,r.useCallback)((({target:e})=>{return t=e.value,n((n=>e.checked?n.concat(t):n.filter((e=>e!==t))));var t}),[]),m=(0,r.useMemo)((()=>(f||[]).map((({name:e,...t})=>({...t,name:e,href:`${I}/api/audio/${encodeURIComponent(e)}`})))),[f]),E=(0,r.useCallback)((e=>(({name:e,href:t,title:n,album:r,artists:o,artwork:i})=>(u(t),a(Object.assign(n?{title:n,album:r,artist:o.join(", ")}:{title:e},i&&{artwork:i.map((({src:e,...n})=>({src:new URL(`${t}/${e}`,document.location.origin||"").toString(),...n})))}))))(m.find((t=>t.href===e)))),[m]),S=(0,r.useCallback)((()=>{if(console.log(["onEnded"]),t.length>0){const e=t.indexOf(s)+1;E(e<t.length?t[e]:t[0])}}),[s,t]),x=s,k=(0,r.useMemo)((()=>m.filter((e=>e.name.toLocaleLowerCase().includes(h.search)))),[m,h]);return console.log({filtered:k,list:m,meta:c}),r.createElement(w,null,r.createElement(d,{setQueries:v}),r.createElement("ul",null,k.map((({name:e,href:o,title:i,artists:l,picture:s},u)=>r.createElement("li",{key:u,style:{display:"flex",flexDirection:"row",padding:1,alignItems:"center",background:o===x?"aliceblue":""}},r.createElement("input",{type:"checkbox",value:o,checked:t.includes(o),onChange:y}),s&&s.map(((e,t)=>r.createElement("img",{key:t,src:e,width:"50",height:"50"}))),r.createElement(b,{style:{padding:4},title:i?`${l.join(", ")} - ${i}`:e,onPress:()=>(n([o]),E(o))}))))),r.createElement(g,{uri:s,loop:1===t.length&&t.includes(s),meta:c,onEnded:S}),r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:o,onChange:({target:e})=>i(e.checked)}),r.createElement("span",null,"loop")),r.createElement(C,{data:f}))}function j(){return r.createElement(w,null,r.createElement(m,null,`API_URL: ${I}`),r.createElement(_,null),r.createElement(r.Suspense,{fallback:r.createElement(O,null)},r.createElement(P,null)))}},45479:(e,t,n)=>{n.d(t,{B:()=>c});var r=n(58932),o=n(22020),i=n(48076),l=(0,n(99871).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),s=n(72938),u=n(98980),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.C6)(t,e),t.prototype.lift=function(e){var t=new a(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new l},t.prototype.next=function(e){var t=this;(0,u.Y)((function(){var n,o;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,r.Ju)(t.currentObservers),l=i.next();!l.done;l=i.next())l.value.next(e)}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,o=n.isStopped,l=n.observers;return r||o?i.Kn:(this.currentObservers=null,l.push(e),new i.yU((function(){t.currentObservers=null,(0,s.o)(l,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,o=t.isStopped;n?e.error(r):o&&e.complete()},t.prototype.asObservable=function(){var e=new o.c;return e.source=this,e},t.create=function(e,t){return new a(e,t)},t}(o.c),a=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.C6)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:i.Kn},t}(c)},52228:(e,t,n)=>{n.d(t,{B:()=>p});var r=n(58932),o=function(e){function t(t,n){return e.call(this)||this}return(0,r.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(48076).yU),i={setInterval:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var l=i.delegate;return(null==l?void 0:l.setInterval)?l.setInterval.apply(l,(0,r.fX)([e,t],(0,r.zs)(n))):setInterval.apply(void 0,(0,r.fX)([e,t],(0,r.zs)(n)))},clearInterval:function(e){var t=i.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},l=n(72938),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,r.C6)(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),i.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&i.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,l.o)(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o),u={now:function(){return(u.delegate||Date).now()},delegate:void 0},c=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=u.now,e}(),a=new(function(e){function t(t,n){void 0===n&&(n=c.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,r.C6)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(c))(s),f=n(45424),h=n(26634);function p(e,t){return void 0===t&&(t=a),(0,f.N)((function(n,r){var o=null,i=null,l=null,s=function(){if(o){o.unsubscribe(),o=null;var e=i;i=null,r.next(e)}};function u(){var n=l+e,i=t.now();if(i<n)return o=this.schedule(void 0,n-i),void r.add(o);s()}n.subscribe((0,h._)(r,(function(n){i=n,l=t.now(),o||(o=t.schedule(u,e),r.add(o))}),(function(){s(),r.complete()}),void 0,(function(){i=o=null})))}))}},42216:(e,t,n)=>{n.d(t,{F:()=>l});var r=n(35383),o=n(45424),i=n(26634);function l(e,t){return void 0===t&&(t=r.D),e=null!=e?e:s,(0,o.N)((function(n,r){var o,l=!0;n.subscribe((0,i._)(r,(function(n){var i=t(n);!l&&e(o,i)||(l=!1,o=i,r.next(n))})))}))}function s(e,t){return e===t}},37239:(e,t,n)=>{n.d(t,{M:()=>s});var r=n(29141),o=n(45424),i=n(26634),l=n(35383);function s(e,t,n){var s=(0,r.T)(e)||t||n?{next:e,error:t,complete:n}:e;return s?(0,o.N)((function(e,t){var n;null===(n=s.subscribe)||void 0===n||n.call(s);var r=!0;e.subscribe((0,i._)(t,(function(e){var n;null===(n=s.next)||void 0===n||n.call(s,e),t.next(e)}),(function(){var e;r=!1,null===(e=s.complete)||void 0===e||e.call(s),t.complete()}),(function(e){var n;r=!1,null===(n=s.error)||void 0===n||n.call(s,e),t.error(e)}),(function(){var e,t;r&&(null===(e=s.unsubscribe)||void 0===e||e.call(s)),null===(t=s.finalize)||void 0===t||t.call(s)})))})):l.D}},58932:(e,t,n)=>{n.d(t,{AQ:()=>h,C6:()=>o,Cl:()=>i,Ju:()=>u,N3:()=>f,YH:()=>s,fX:()=>a,sH:()=>l,xN:()=>p,zs:()=>c});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function l(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(l=0)),l;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,r=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((o=(o=l.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){l.label=s[1];break}if(6===s[0]&&l.label<o[1]){l.label=o[1],o=s;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(s);break}o[2]&&l.ops.pop(),l.trys.pop();continue}s=t.call(e,l)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return l}function a(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function f(e){return this instanceof f?(this.v=e,this):new f(e)}function h(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof f?Promise.resolve(n.value.v).then(u,c):a(i[0][2],n)}catch(e){a(i[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function a(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function p(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}}]);
//# sourceMappingURL=15.js.map