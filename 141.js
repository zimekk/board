"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[141],{45141:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(92588),r=n.n(a),l=n(96364),i=n(61661);const o=i.Ik({live:i.g1(i.Yj(),i.Ik({publisher:i.Ik({app:i.Yj(),stream:i.Yj(),clientId:i.Yj(),connectCreated:i.Yj(),bytes:i.ai(),ip:i.Yj(),audio:i.Ik({codec:i.Yj(),profile:i.Yj(),samplerate:i.ai(),channels:i.ai()}).nullable(),video:i.Ik({codec:i.Yj(),width:i.ai(),height:i.ai(),profile:i.Yj(),level:i.ai(),fps:i.ai()})}),subscribers:i.YO(i.L5())})).optional()}),s=(({protocol:e,hostname:t})=>`${e}//${t}:7000`)(new URL(window.location.href));function c({stream:e}){const[t,n]=(0,l.useState)(null),a=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(r().isSupported()){const t=a.current,l=r().createPlayer({type:"flv",url:e});l.attachMediaElement(t),l.on(r().Events.ERROR,n),l.load()}},[e]),l.createElement("div",null,l.createElement("video",{ref:a,width:"480",height:"270",autoPlay:!0,controls:!0}),t&&l.createElement("pre",{style:{background:"crimson",color:"white",margin:".5em",padding:"1em"}},JSON.stringify(t)))}function m({stream:e}){return l.createElement("div",null,l.createElement("video",{crossOrigin:"anonymous",src:e,width:"480",height:"270",autoPlay:!0,controls:!0}))}function u(){const[e,t]=(0,l.useState)(()=>({value:"",error:""})),[n,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(null);(0,l.useEffect)(()=>{(window?Promise.resolve({live:{NZXT:{}}}):fetch(`${s}/api/streams`,{headers:{Authorization:`Basic ${btoa(["admin","admin"].join(":"))}`}}).then(e=>e.json()).then(o.parseAsync)).then(e=>Object.keys(e.live||{}).map(e=>`${s}/live/${e}.flv`)).then(e=>e.length>0&&(a(e),i(e[0])))},[]);const u=(0,l.useCallback)(({target:e})=>i(e.value),[]),d=(0,l.useCallback)(n=>{n.preventDefault();try{const n=new URL(e.value).toString();console.log({url:n}),a(e=>e.filter(e=>e!==n).concat(n)),t(e=>({...e,value:""})),i(n)}catch(n){t(e=>({...e,error:n.toString()}))}},[e.value]);return l.createElement("section",null,l.createElement("h2",null,"Stream"),l.createElement("div",{style:{display:"flex",flexDirection:"column",width:480}},l.createElement("form",{onSubmit:d},l.createElement("div",{style:{display:"flex",flex:"1 auto"}},l.createElement("input",{style:{flexGrow:1,margin:".25em"},type:"text",value:e.value,onChange:({target:e})=>t(t=>({...t,value:e.value,error:""}))}),l.createElement("button",{style:{margin:".25em",height:"2em"},disabled:e.value.length<=0},"add")),e.error&&l.createElement("pre",{style:{background:"crimson",color:"white",margin:".5em",padding:"1em"}},e.error)),r&&n&&l.createElement("select",{style:{margin:".25em",height:"2em"},value:r,onChange:u},n.map(e=>l.createElement("option",{key:e,value:e},e))),r&&l.createElement(c,{stream:r})),l.createElement("a",{href:`${s}/admin/streams`,target:"_blank"},"streams"),l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},"~ $ git clone https://github.com/illuspas/Node-Media-Server\n\n~/Node-Media-Server $ docker build . -t nms\n~/Node-Media-Server $ docker run --name nms -d -p 1935:1935 -p 7000:8000 -p 8443:8443 nms\n"),r&&l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},`ffmpeg -stream_loop -1 -re -i share/library/BilaShsQphM.mp4 -c copy -f flv ${p=new URL(r),`rtmp://${p.hostname}${p.pathname.split(".")[0]}`}\n`),l.createElement("h2",null,"MJPEGStream"),l.createElement(m,{stream:"//192.168.2.23:8080/feed.mjpg"}),l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},'gphoto2 --set-config viewfinder=1\ngphoto2 --capture-movie --stdout | ffmpeg -re -i pipe:0 -pix_fmt yuv420p -s:v 1920x1080 -listen 1 -headers "Access-Control-Allow-Origin: *" -f mjpeg http://192.168.2.23:8080/feed.mjpg\n'));var p}}}]);
//# sourceMappingURL=141.js.map