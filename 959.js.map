{"version":3,"file":"959.js","mappings":"kWAKe,SAASA,GAAY,MAClCC,EAAK,OACLC,KACGC,IAMH,OACEC,EAAAA,cAACC,EAAAA,SAAQ,CAACC,SAAU,MAClBF,EAAAA,cAACG,EAAAA,EAAYC,EAAA,CACXC,UAAQ,GACJN,EAAI,CACRO,MAAO,CAAEC,QAAS,QAASV,QAAOC,UAClCU,OAAQ,CAAC,KAIjB,C,8CClBA,MAAMC,E,SAAgBC,GAAOC,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA+CzB,SAASC,IACd,OACEZ,EAAAA,cAACS,EAAa,KACZT,EAAAA,cAAA,OAAKa,UAAU,UAAUC,QAAQ,aAC/Bd,EAAAA,cAAA,UACEa,UAAU,OACVE,GAAG,KACHC,GAAG,KACHC,EAAE,KACFC,KAAK,OACLC,YAAY,OAKtB,C,oJC1DO,MAAMC,EAAW,GAAIC,WAAUC,cACpC,GAAGA,MAAaD,SADM,CAEtB,IAAIE,IACF,GAA2BC,OAAOC,SAASC,OAAOC,QAChD,aACA,WAKN,SAASC,IACP,MAAOC,EAAMC,IAAWC,EAAAA,EAAAA,UAAsB,IAAM,OAEpDC,EAAAA,EAAAA,WAAU,KACRC,MAAM,SACHC,KAAMC,GAAQA,EAAIC,QAClBF,KAAK,EAAGL,UAAWA,GACnBK,KAAKJ,IACP,IAEH,MAAMO,GAAeC,EAAAA,EAAAA,aAClBC,IACCA,EAAEC,iBACFP,MACE,cAAcQ,mBACXF,EAAEG,OAA6BC,QAAQC,UAI9C,IAGF,OAAa,OAATf,EACK7B,EAAAA,cAACY,EAAAA,EAAO,MAIfZ,EAAAA,cAAA,WACEA,EAAAA,cAAA,UACG6B,EAAKgB,IAAI,EAAGD,UACX5C,EAAAA,cAAA,MAAI8C,IAAKF,GACP5C,EAAAA,cAAA,KACE0B,KAAM,SAASe,mBAAmBG,KAClC,YAAWA,EACXF,OAAO,SACPK,QAASV,GAERO,MAOf,CAEA,SAASI,IACP,MAAOC,EAAMC,IAAWnB,EAAAA,EAAAA,UAAS,MAyBjC,OAvBAC,EAAAA,EAAAA,WAAU,KACR,MAAMmB,EAASC,EAAAA,EAAKC,QAAQjC,GAiB5B,OAfAkC,QAAQC,IAAI,CAAEnC,aAEd+B,EAAOK,GAAG,UAAW,KACnBL,EAAOM,UAAU,SAAWC,SAO9BP,EAAOK,GAAG,UAAW,CAACG,EAAQC,KAE5BV,EAAQ3B,IAAIsC,gBAAgB,IAAIC,KAAK,CAACF,QAGjC,KACLT,EAAOY,QAER,IAEId,EACLjD,EAAAA,cAAA,OACEM,MAAO,CAEL0D,OAAQ,EACRC,MAAO,EACPC,OAAQ,oBAGVlE,EAAAA,cAAA,OACEM,MAAO,CACL6D,SAAU,QAEZC,IAAKnB,KAGP,IACN,CAEe,SAASoB,IACtB,OACErE,EAAAA,cAAA,eACEA,EAAAA,cAAA,UAAI,SACJA,EAAAA,cAAC4B,EAAI,MACL5B,EAAAA,cAACgD,EAAI,MAGX,C","sources":["webpack://@dev/web/../video/src/components/ReactPlayer/index.tsx","webpack://@dev/web/../video/src/components/Spinner/index.tsx","webpack://@dev/web/../photo/src/containers/index.tsx"],"sourcesContent":["import React, { Suspense, type ComponentProps } from \"react\";\nimport YoutubeVideo from \"youtube-video-element/react\";\n\n// https://github.com/muxinc/media-elements/blob/main/examples/nextjs/app/youtube-video/page.tsx\n// https://github.com/muxinc/media-elements/blob/main/examples/nextjs/app/player.client.tsx\nexport default function ReactPlayer({\n  width,\n  height,\n  ...rest\n}: ComponentProps<typeof YoutubeVideo> & {\n  light: boolean;\n  pip: boolean;\n  playing: boolean;\n}) {\n  return (\n    <Suspense fallback={null}>\n      <YoutubeVideo\n        autoplay\n        {...rest}\n        style={{ display: \"block\", width, height }}\n        config={{}}\n      />\n    </Suspense>\n  );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\n// https://codepen.io/GeoffreyCrofte/pen/ZQrgZm\n// https://codepen.io/supah/pen/BjYLdW\n// https://codesandbox.io/s/m3v440z36j\nconst StyledSpinner = styled.div`\n  display: inline-block;\n  width: 1em;\n  height: 1em;\n  position: relative;\n\n  .spinner {\n    position: absolute;\n    width: 1.5em;\n    height: 1.5em;\n    margin: 0;\n  }\n\n  svg {\n    animation: rotate 2s linear infinite;\n    margin: -25px 0 0 -25px;\n    width: 50px;\n    height: 50px;\n\n    & .path {\n      stroke: #5652bf;\n      stroke-linecap: round;\n      animation: dash 1.5s ease-in-out infinite;\n    }\n  }\n\n  @keyframes rotate {\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  @keyframes dash {\n    0% {\n      stroke-dasharray: 1, 150;\n      stroke-dashoffset: 0;\n    }\n    50% {\n      stroke-dasharray: 90, 150;\n      stroke-dashoffset: -35;\n    }\n    100% {\n      stroke-dasharray: 90, 150;\n      stroke-dashoffset: -124;\n    }\n  }\n`;\n\nexport function Spinner() {\n  return (\n    <StyledSpinner>\n      <svg className=\"spinner\" viewBox=\"0 0 50 50\">\n        <circle\n          className=\"path\"\n          cx=\"25\"\n          cy=\"25\"\n          r=\"20\"\n          fill=\"none\"\n          strokeWidth=\"5\"\n        />\n      </svg>\n    </StyledSpinner>\n  );\n}\n","import { Spinner } from \"@dev/video/components\";\nimport mqtt from \"mqtt\";\nimport React, {\n  type MouseEventHandler,\n  useCallback,\n  useEffect,\n  useState,\n} from \"react\";\nimport { type PhotoType } from \"../schema\";\n\nexport const MQTT_URL = (({ hostname, protocol }) =>\n  `${protocol}//${hostname}:9001`)(\n  new URL(\n    `${process.env.MQTT_URL || window.location.href}`.replace(\n      /^mqtt:\\/\\//,\n      \"ws://\",\n    ),\n  ),\n);\n\nfunction List() {\n  const [list, setList] = useState<PhotoType[]>(() => null);\n\n  useEffect(() => {\n    fetch(\"photo\")\n      .then((res) => res.json())\n      .then(({ list }) => list)\n      .then(setList);\n  }, []);\n\n  const handleSelect = useCallback<MouseEventHandler<HTMLAnchorElement>>(\n    (e) => (\n      e.preventDefault(),\n      fetch(\n        `photo/send/${encodeURIComponent(\n          (e.target as HTMLAnchorElement).dataset.name,\n        )}`,\n      )\n    ),\n    [],\n  );\n\n  if (list === null) {\n    return <Spinner />;\n  }\n\n  return (\n    <div>\n      <ul>\n        {list.map(({ name }) => (\n          <li key={name}>\n            <a\n              href={`photo/${encodeURIComponent(name)}`}\n              data-name={name}\n              target=\"_blank\"\n              onClick={handleSelect}\n            >\n              {name}\n            </a>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nfunction Item() {\n  const [item, setItem] = useState(null);\n\n  useEffect(() => {\n    const client = mqtt.connect(MQTT_URL);\n\n    console.log({ MQTT_URL });\n\n    client.on(\"connect\", () => {\n      client.subscribe(\"photos\", (err) => {\n        // if (!err) {\n        //   client.publish(\"presence\", \"Hello mqtt\");\n        // }\n      });\n    });\n\n    client.on(\"message\", (_topic, message) => {\n      // message is Buffer\n      setItem(URL.createObjectURL(new Blob([message as BlobPart])));\n    });\n\n    return () => {\n      client.end();\n    };\n  }, []);\n\n  return item ? (\n    <div\n      style={{\n        // position: \"fixed\",\n        bottom: 0,\n        right: 0,\n        border: \"2px solid black\",\n      }}\n    >\n      <img\n        style={{\n          maxWidth: \"100%\",\n        }}\n        src={item}\n      />\n    </div>\n  ) : null;\n}\n\nexport default function Section() {\n  return (\n    <section>\n      <h2>Photo</h2>\n      <List />\n      <Item />\n    </section>\n  );\n}\n"],"names":["ReactPlayer","width","height","rest","React","Suspense","fallback","YoutubeVideo","_extends","autoplay","style","display","config","StyledSpinner","styled","div","Spinner","className","viewBox","cx","cy","r","fill","strokeWidth","MQTT_URL","hostname","protocol","URL","window","location","href","replace","List","list","setList","useState","useEffect","fetch","then","res","json","handleSelect","useCallback","e","preventDefault","encodeURIComponent","target","dataset","name","map","key","onClick","Item","item","setItem","client","mqtt","connect","console","log","on","subscribe","err","_topic","message","createObjectURL","Blob","end","bottom","right","border","maxWidth","src","Section"],"ignoreList":[],"sourceRoot":""}