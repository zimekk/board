"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[858],{44848:(e,t,n)=>{n.d(t,{M:()=>l});var r=n(68030),o=n(11183),i=n(91243),s=n(84828);function l(e,t,n){var l=(0,r.T)(e)||t||n?{next:e,error:t,complete:n}:e;return l?(0,o.N)((function(e,t){var n;null===(n=l.subscribe)||void 0===n||n.call(l);var r=!0;e.subscribe((0,i._)(t,(function(e){var n;null===(n=l.next)||void 0===n||n.call(l,e),t.next(e)}),(function(){var e;r=!1,null===(e=l.complete)||void 0===e||e.call(l),t.complete()}),(function(e){var n;r=!1,null===(n=l.error)||void 0===n||n.call(l,e),t.error(e)}),(function(){var e,t;r&&(null===(e=l.unsubscribe)||void 0===e||e.call(l)),null===(t=l.finalize)||void 0===t||t.call(l)})))})):s.D}},57315:(e,t,n)=>{n.d(t,{B:()=>h});var r=n(65959),o=function(e){function t(t,n){return e.call(this)||this}return(0,r.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(64307).yU),i={setInterval:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var s=i.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,(0,r.fX)([e,t],(0,r.zs)(n))):setInterval.apply(void 0,(0,r.fX)([e,t],(0,r.zs)(n)))},clearInterval:function(e){var t=i.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},s=n(28827),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,r.C6)(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),i.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&i.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,s.o)(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o),u={now:function(){return(u.delegate||Date).now()},delegate:void 0},c=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=u.now,e}(),a=new(function(e){function t(t,n){void 0===n&&(n=c.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,r.C6)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(c))(l),d=n(11183),f=n(91243);function h(e,t){return void 0===t&&(t=a),(0,d.N)((function(n,r){var o=null,i=null,s=null,l=function(){if(o){o.unsubscribe(),o=null;var e=i;i=null,r.next(e)}};function u(){var n=s+e,i=t.now();if(i<n)return o=this.schedule(void 0,n-i),void r.add(o);l()}n.subscribe((0,f._)(r,(function(n){i=n,s=t.now(),o||(o=t.schedule(u,e),r.add(o))}),(function(){l(),r.complete()}),void 0,(function(){i=o=null})))}))}},63638:(e,t,n)=>{n.d(t,{B:()=>c});var r=n(65959),o=n(29739),i=n(64307),s=(0,n(27412).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),l=n(28827),u=n(52787),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.C6)(t,e),t.prototype.lift=function(e){var t=new a(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new s},t.prototype.next=function(e){var t=this;(0,u.Y)((function(){var n,o;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,r.Ju)(t.currentObservers),s=i.next();!s.done;s=i.next())s.value.next(e)}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,o=n.isStopped,s=n.observers;return r||o?i.Kn:(this.currentObservers=null,s.push(e),new i.yU((function(){t.currentObservers=null,(0,l.o)(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,o=t.isStopped;n?e.error(r):o&&e.complete()},t.prototype.asObservable=function(){var e=new o.c;return e.source=this,e},t.create=function(e,t){return new a(e,t)},t}(o.c),a=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.C6)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:i.Kn},t}(c)},69858:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var r=n(22155);const o=[];function i(e,t,n=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let o=0;o<r;o++)if(!n(e[o],t[o]))return!1;return!0}const s=(e,t,n)=>function(e,t=null,n=!1,r={}){null===t&&(t=[e]);for(const e of o)if(i(t,e.keys,e.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return r.lifespan&&r.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,r.lifespan)),e.response;if(!n)throw e.promise}const s={keys:t,equal:r.equal,remove:()=>{const e=o.indexOf(s);-1!==e&&o.splice(e,1)},promise:(l=e,"object"==typeof l&&"function"==typeof l.then?e:e(...t)).then((e=>{s.response=e,r.lifespan&&r.lifespan>0&&(s.timeout=setTimeout(s.remove,r.lifespan))})).catch((e=>s.error=e))};var l;if(o.push(s),!n)throw s.promise}(e,t,!1,n);var l=n(63638),u=n(14291),c=n(79101),a=n(57315);const d={search:""},f=({search:e,...t})=>JSON.stringify({...t,search:e.toLowerCase().trim()}),h=()=>JSON.parse(f(d));function p({setQueries:e}){const[t,n]=(0,r.useState)(d),o=(0,r.useMemo)((()=>new l.B),[]);return(0,r.useEffect)((()=>{const t=o.pipe((0,u.T)(f),(0,c.F)(),(0,a.B)(400)).subscribe((t=>e((e=>({...e,...JSON.parse(t)})))));return()=>t.unsubscribe()}),[o]),(0,r.useEffect)((()=>{o.next(t)}),[t]),r.createElement("div",null,r.createElement("input",{type:"search",value:t.search,onChange:(0,r.useCallback)((({target:e})=>n((t=>({...t,search:e.value})))),[])}))}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(null,arguments)}const b=({title:e,onPress:t,...n})=>r.createElement("button",v({onClick:t},n),e),m=({title:e,onPress:t,...n})=>r.createElement("a",v({href:"#",onClick:t?e=>(e.preventDefault(),t(e)):void 0},n),e),y="div",E="div";function g({uri:e,loop:t,meta:n,onEnded:o}){const[i,s]=(0,r.useState)(!1),l=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=l.current;if(e){const t=e=>(console.log(["onPlay"],e),s(!0)),n=e=>(console.log(["onPause"],e),s(!1));return e.addEventListener("play",t),e.addEventListener("pause",n),e.addEventListener("ended",o),()=>{e.removeEventListener("play",t),e.removeEventListener("pause",n),e.removeEventListener("ended",o)}}}),[l,o]),(0,r.useEffect)((()=>{i&&"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata(n))}),[i,n]),r.createElement(E,null,i?r.createElement(b,{title:"Pause",onPress:async function(){l.current&&l.current.pause()}}):r.createElement(b,{title:"Play",onPress:async function(){l.current&&(await l.current.play(),console.log(["play"]))},disabled:!e}),r.createElement("audio",{ref:l,src:e,loop:t,autoPlay:!0,controls:!0}),r.createElement(b,{title:"Forward",onPress:()=>{const e=l.current;e&&e.duration&&(e.currentTime=e.duration-3)},disabled:!l}))}var w=n(11183),k=n(91243);var S=n(44848);const C=()=>"volume-list";function _(){const[e,t]=(0,r.useState)(NaN);(0,r.useEffect)((()=>{fetch("api/audio/volume").then((e=>e.json())).then((({volume:e})=>e)).then(t)}),[]);const n=(0,r.useMemo)((()=>new l.B),[]);(0,r.useEffect)((()=>{const e=n.pipe((t=1,r=function(e,n){return t<=n},(0,w.N)((function(e,t){var n=0;e.subscribe((0,k._)(t,(function(e){return r.call(void 0,e,n++)&&t.next(e)})))}))),(0,S.M)(console.log),(0,c.F)(),(0,a.B)(400)).subscribe((e=>fetch(`api/audio/volume/${e}`).then((e=>e.json())).then(console.log)));var t,r;return()=>e.unsubscribe()}),[n]),(0,r.useEffect)((()=>{Number.isNaN(e)||n.next(e)}),[e]);const o=(0,r.useCallback)((({target:e})=>t(Number(e.value))),[]),i=C();return r.createElement("div",null,!Number.isNaN(e)&&r.createElement("input",{type:"range",list:i,min:"0",max:"100",value:e,onChange:o}),r.createElement("datalist",{id:i},[...Array(11)].map(((e,t,n)=>r.createElement("option",{key:t,value:100/(n.length-1)*t})))))}function x(){return r.createElement(E,null,r.createElement(y,null,"Loading..."))}function I({data:e,expanded:t=!1}){const[n,o]=(0,r.useState)(t);return r.createElement("pre",null,n?JSON.stringify(e,null,2):r.createElement(r.Fragment,null,"[",r.createElement("a",{href:"#",onClick:e=>(e.preventDefault(),o(!0))},"..."),"]"))}const O="";function N({version:e=1}){const[t,n]=(0,r.useState)([]),[o,i]=(0,r.useState)(!1),[l,u]=(0,r.useState)(),[c,a]=(0,r.useState)(),d=s((async()=>(await fetch(`${O?`${O}/`:""}api/audio?${e}`)).json()),[e]),[f,v]=(0,r.useState)((()=>h())),b=(0,r.useCallback)((({target:e})=>{return t=e.value,n((n=>e.checked?n.concat(t):n.filter((e=>e!==t))));var t}),[]),y=(0,r.useMemo)((()=>(d||[]).map((({name:e,...t})=>({...t,name:e,href:`${O}/api/audio/${encodeURIComponent(e)}`})))),[d]),w=(0,r.useCallback)((e=>(({name:e,href:t,title:n,album:r,artists:o,artwork:i})=>(u(t),a(Object.assign(n?{title:n,album:r,artist:o.join(", ")}:{title:e},i&&{artwork:i.map((({src:e,...n})=>({src:new URL(`${t}/${e}`,document.location.origin||"").toString(),...n})))}))))(y.find((t=>t.href===e)))),[y]),k=(0,r.useCallback)((()=>{if(console.log(["onEnded"]),t.length>0){const e=t.indexOf(l)+1;w(e<t.length?t[e]:t[0])}}),[l,t]),S=l,C=(0,r.useMemo)((()=>y.filter((e=>e.name.toLocaleLowerCase().includes(f.search)))),[y,f]);return console.log({filtered:C,list:y,meta:c}),r.createElement(E,null,r.createElement(p,{setQueries:v}),r.createElement("ul",null,C.map((({name:e,href:o,title:i,artists:s,picture:l},u)=>r.createElement("li",{key:u,style:{display:"flex",flexDirection:"row",padding:1,alignItems:"center",background:o===S?"aliceblue":""}},r.createElement("input",{type:"checkbox",value:o,checked:t.includes(o),onChange:b}),l&&l.map(((e,t)=>r.createElement("img",{key:t,src:e,width:"50",height:"50"}))),r.createElement(m,{style:{padding:4},title:i?`${s.join(", ")} - ${i}`:e,onPress:()=>(n([o]),w(o))}))))),r.createElement(g,{uri:l,loop:1===t.length&&t.includes(l),meta:c,onEnded:k}),r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:o,onChange:({target:e})=>i(e.checked)}),r.createElement("span",null,"loop")),r.createElement(I,{data:d}))}function P(){return r.createElement(E,null,r.createElement(y,null,`API_URL: ${O}`),r.createElement(_,null),r.createElement(r.Suspense,{fallback:r.createElement(x,null)},r.createElement(N,null)))}},79101:(e,t,n)=>{n.d(t,{F:()=>s});var r=n(84828),o=n(11183),i=n(91243);function s(e,t){return void 0===t&&(t=r.D),e=null!=e?e:l,(0,o.N)((function(n,r){var o,s=!0;n.subscribe((0,i._)(r,(function(n){var i=t(n);!s&&e(o,i)||(s=!1,o=i,r.next(n))})))}))}function l(e,t){return e===t}}}]);
//# sourceMappingURL=858.js.map