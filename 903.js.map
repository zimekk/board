{"version":3,"file":"903.js","mappings":"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","sources":["webpack://@dev/web/../../node_modules/.pnpm/suspend-react@0.1.0_react@18.2.0/node_modules/suspend-react/dist/index.js","webpack://@dev/web/./src/containers/Audio/Filters/index.tsx","webpack://@dev/web/./src/containers/Audio/Player/index.tsx","webpack://@dev/web/./src/containers/Audio/index.tsx"],"sourcesContent":["const isPromise = promise => typeof promise === 'object' && typeof promise.then === 'function';\n\nconst globalCache = [];\n\nfunction shallowEqualArrays(arrA, arrB, equal = (a, b) => a === b) {\n  if (arrA === arrB) return true;\n  if (!arrA || !arrB) return false;\n  const len = arrA.length;\n  if (arrB.length !== len) return false;\n\n  for (let i = 0; i < len; i++) if (!equal(arrA[i], arrB[i])) return false;\n\n  return true;\n}\n\nfunction query(fn, keys = null, preload = false, config = {}) {\n  // If no keys were given, the function is the key\n  if (keys === null) keys = [fn];\n\n  for (const entry of globalCache) {\n    // Find a match\n    if (shallowEqualArrays(keys, entry.keys, entry.equal)) {\n      // If we're pre-loading and the element is present, just return\n      if (preload) return undefined; // If an error occurred, throw\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'error')) throw entry.error; // If a response was successful, return\n\n      if (Object.prototype.hasOwnProperty.call(entry, 'response')) {\n        if (config.lifespan && config.lifespan > 0) {\n          if (entry.timeout) clearTimeout(entry.timeout);\n          entry.timeout = setTimeout(entry.remove, config.lifespan);\n        }\n\n        return entry.response;\n      } // If the promise is still unresolved, throw\n\n\n      if (!preload) throw entry.promise;\n    }\n  } // The request is new or has changed.\n\n\n  const entry = {\n    keys,\n    equal: config.equal,\n    remove: () => {\n      const index = globalCache.indexOf(entry);\n      if (index !== -1) globalCache.splice(index, 1);\n    },\n    promise: // Execute the promise\n    (isPromise(fn) ? fn : fn(...keys) // When it resolves, store its value\n    ).then(response => {\n      entry.response = response; // Remove the entry in time if a lifespan was given\n\n      if (config.lifespan && config.lifespan > 0) {\n        entry.timeout = setTimeout(entry.remove, config.lifespan);\n      }\n    }) // Store caught errors, they will be thrown in the render-phase to bubble into an error-bound\n    .catch(error => entry.error = error)\n  }; // Register the entry\n\n  globalCache.push(entry); // And throw the promise, this yields control back to React\n\n  if (!preload) throw entry.promise;\n  return undefined;\n}\n\nconst suspend = (fn, keys, config) => query(fn, keys, false, config);\n\nconst preload = (fn, keys, config) => void query(fn, keys, true, config);\n\nconst peek = keys => {\n  var _globalCache$find;\n\n  return (_globalCache$find = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal))) == null ? void 0 : _globalCache$find.response;\n};\n\nconst clear = keys => {\n  if (keys === undefined || keys.length === 0) globalCache.splice(0, globalCache.length);else {\n    const entry = globalCache.find(entry => shallowEqualArrays(keys, entry.keys, entry.equal));\n    if (entry) entry.remove();\n  }\n};\n\nexport { clear, peek, preload, suspend };\n","import React, {\n  type Dispatch,\n  type SetStateAction,\n  useEffect,\n  useMemo,\n  useState,\n  useCallback,\n} from \"react\";\nimport { Subject, debounceTime, distinctUntilChanged, map } from \"rxjs\";\n\nconst INITIAL_FILTERS = {\n  search: \"\",\n};\n\ntype FiltersState = typeof INITIAL_FILTERS;\n\nexport const stringifyFilters = ({ search, ...filters }: FiltersState) =>\n  JSON.stringify({\n    ...filters,\n    search: search.toLowerCase().trim(),\n  });\n\nexport const initialQueries = () =>\n  JSON.parse(stringifyFilters(INITIAL_FILTERS));\n\nexport default function Filters({\n  setQueries,\n}: {\n  setQueries: Dispatch<SetStateAction<FiltersState>>;\n}) {\n  const [filters, setFilters] = useState(INITIAL_FILTERS);\n  const search$ = useMemo(() => new Subject<any>(), []);\n\n  useEffect(() => {\n    const subscription = search$\n      .pipe(map(stringifyFilters), distinctUntilChanged(), debounceTime(400))\n      .subscribe((filters) =>\n        setQueries((queries) => ({ ...queries, ...JSON.parse(filters) }))\n      );\n    return () => subscription.unsubscribe();\n  }, [search$]);\n\n  useEffect(() => {\n    search$.next(filters);\n  }, [filters]);\n\n  return (\n    <div>\n      <input\n        type=\"search\"\n        value={filters.search}\n        onChange={useCallback(\n          ({ target }) =>\n            setFilters((filters) => ({\n              ...filters,\n              search: target.value,\n            })),\n          []\n        )}\n      />\n    </div>\n  );\n}\n","import React, {\n  ComponentProps,\n  MouseEventHandler,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nexport interface MetaType {\n  title: string;\n  album?: string;\n  artist?: string;\n  artwork?: { src: string }[];\n}\n\nexport const Button = ({\n  title,\n  onPress,\n  ...rest\n}: {\n  title: string;\n  onPress: MouseEventHandler;\n  disabled?: boolean;\n}) => (\n  <button onClick={onPress} {...rest}>\n    {title}\n  </button>\n);\n\nexport const Link = ({\n  title,\n  onPress,\n  ...rest\n}: ComponentProps<\"a\"> & {\n  title: string;\n  onPress: MouseEventHandler;\n}) => (\n  <a\n    href=\"#\"\n    onClick={onPress ? (e) => (e.preventDefault(), onPress(e)) : undefined}\n    {...rest}\n  >\n    {title}\n  </a>\n);\n\nexport const Text = \"div\";\nexport const View = \"div\";\n\nexport default function Player({\n  uri,\n  loop,\n  meta,\n  onEnded,\n}: {\n  uri: string;\n  loop: boolean;\n  meta: MetaType;\n  onEnded?: () => void;\n}) {\n  const [playing, setPlaying] = useState(false);\n  const ref = useRef<HTMLAudioElement>(null);\n\n  async function play() {\n    if (ref.current) {\n      await ref.current.play();\n      console.log([\"play\"]);\n    }\n  }\n\n  async function pause() {\n    if (ref.current) {\n      ref.current.pause();\n    }\n  }\n\n  useEffect(() => {\n    const audio = ref.current;\n    if (audio) {\n      const onPlay = (e) => (console.log([\"onPlay\"], e), setPlaying(true));\n      const onPause = (e) => (console.log([\"onPause\"], e), setPlaying(false));\n      // const onEnded = (e) => (console.log([\"onEnded\"], e));\n\n      audio.addEventListener(\"play\", onPlay);\n      audio.addEventListener(\"pause\", onPause);\n      audio.addEventListener(\"ended\", onEnded);\n\n      return () => {\n        audio.removeEventListener(\"play\", onPlay);\n        audio.removeEventListener(\"pause\", onPause);\n        audio.removeEventListener(\"ended\", onEnded);\n      };\n    }\n  }, [ref, onEnded]);\n\n  useEffect(() => {\n    if (playing) {\n      // https://web.dev/media-session/\n      if (\"mediaSession\" in navigator) {\n        navigator.mediaSession.metadata = new MediaMetadata(meta);\n      }\n    }\n  }, [playing, meta]);\n\n  return (\n    <View>\n      {playing ? (\n        <Button title=\"Pause\" onPress={pause} />\n      ) : (\n        <Button title=\"Play\" onPress={play} disabled={!uri} />\n      )}\n      <audio ref={ref} src={uri} loop={loop} autoPlay controls />\n      <Button\n        title=\"Forward\"\n        onPress={() => {\n          const audio = ref.current;\n          if (audio && audio.duration) {\n            audio.currentTime = audio.duration - 3;\n          }\n        }}\n        disabled={!ref}\n      />\n    </View>\n  );\n}\n","import React, {\n  type ChangeEventHandler,\n  Suspense,\n  useCallback,\n  useMemo,\n  useState,\n} from \"react\";\nimport { suspend } from \"suspend-react\";\n\nimport Filters, { initialQueries } from \"./Filters\";\nimport Player, { MetaType, Link, Text, View } from \"./Player\";\n\nfunction Loading() {\n  return (\n    <View>\n      <Text>Loading...</Text>\n    </View>\n  );\n}\n\nfunction Data({\n  data,\n  expanded: initialExpanded = false,\n}: {\n  data: object;\n  expanded?: boolean;\n}) {\n  const [expanded, setExpanded] = useState(initialExpanded);\n\n  return (\n    <pre>\n      {expanded ? (\n        JSON.stringify(data, null, 2)\n      ) : (\n        <>\n          [\n          <a href=\"#\" onClick={(e) => (e.preventDefault(), setExpanded(true))}>\n            ...\n          </a>\n          ]\n        </>\n      )}\n    </pre>\n  );\n}\n\nconst API_URL = process.env.API_URL || \"\";\n\ninterface ItemType {\n  name: string;\n  year?: string;\n  album?: string;\n  title?: string;\n  artists?: string[];\n  artwork?: MetaType[\"artwork\"];\n  picture?: string[];\n}\n\nfunction Playlist({ version = 1 }) {\n  const [selected, setSelected] = useState<string[]>([]);\n  const [loop, setLoop] = useState(false);\n  const [href, setHref] = useState<string | undefined>();\n  const [meta, setMeta] = useState<MetaType | undefined>();\n  const data = suspend(async () => {\n    const res = await fetch(`${API_URL ? `${API_URL}/` : ''}api/audio?${version}`);\n    return res.json() as Promise<ItemType[]>;\n  }, [version]);\n  const [queries, setQueries] = useState(() => initialQueries());\n\n  const handleSelect = useCallback<ChangeEventHandler<HTMLInputElement>>(\n    ({ target }) =>\n      ((id) =>\n        setSelected((selected) =>\n          target.checked\n            ? selected.concat(id)\n            : selected.filter((item) => item !== id)\n        ))(target.value),\n    []\n  );\n\n  const list = useMemo(\n    () =>\n      (data || []).map(({ name, ...rest }) => ({\n        ...rest,\n        name,\n        href: `${API_URL}/api/audio/${encodeURIComponent(name)}`,\n      })),\n    [data]\n  );\n\n  const handlePlay = useCallback(\n    (id: string) =>\n      (({ name, href, title, album, artists, artwork }) => (\n        setHref(href),\n        setMeta(\n          Object.assign(\n            title\n              ? {\n                  title,\n                  album,\n                  artist: artists.join(\", \"),\n                }\n              : { title: name },\n            artwork && {\n              artwork: artwork.map(({ src, ...artwork }) => ({\n                src: new URL(\n                  `${href}/${src}`,\n                  document.location.origin || \"\"\n                ).toString(),\n                ...artwork,\n              })),\n            }\n          )\n        )\n      ))(list.find((item) => item.href === id)),\n    [list]\n  );\n\n  const handleEnded = useCallback(() => {\n    console.log([\"onEnded\"]);\n    if (selected.length > 0) {\n      const index = selected.indexOf(href) + 1;\n      handlePlay(index < selected.length ? selected[index] : selected[0]);\n    }\n  }, [href, selected]);\n\n  const current = href;\n\n  const filtered = useMemo(\n    () =>\n      list.filter((item) =>\n        item.name.toLocaleLowerCase().includes(queries.search)\n      ),\n    [list, queries]\n  );\n\n  console.log({ filtered, list, meta });\n\n  return (\n    <View>\n      <Filters setQueries={setQueries} />\n      <ul>\n        {filtered.map(({ name, href, title, artists, picture }, key) => (\n          <li\n            key={key}\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              padding: 1,\n              alignItems: \"center\",\n              background: href === current ? \"aliceblue\" : \"\",\n            }}\n          >\n            <input\n              type=\"checkbox\"\n              value={href}\n              checked={selected.includes(href)}\n              onChange={handleSelect}\n            />\n            {picture &&\n              picture.map((src, key) => (\n                <img key={key} src={src} width=\"50\" height=\"50\" />\n              ))}\n            <Link\n              style={{ padding: 4 }}\n              title={title ? `${artists.join(\", \")} - ${title}` : name}\n              onPress={() => (setSelected([href]), handlePlay(href))}\n            />\n          </li>\n        ))}\n      </ul>\n      <Player\n        uri={href}\n        loop={selected.length === 1 && selected.includes(href)}\n        meta={meta}\n        onEnded={handleEnded}\n      />\n      <label>\n        <input\n          type=\"checkbox\"\n          checked={loop}\n          onChange={({ target }) => setLoop(target.checked)}\n        />\n        <span>loop</span>\n      </label>\n      <Data data={data} />\n    </View>\n  );\n}\n\nexport default function Audio() {\n  return (\n    <View>\n      <Text>{`API_URL: ${API_URL}`}</Text>\n      <Suspense fallback={<Loading />}>\n        <Playlist />\n      </Suspense>\n    </View>\n  );\n}\n"],"names":["globalCache","shallowEqualArrays","arrA","arrB","equal","a","b","len","length","i","suspend","fn","keys","config","preload","entry","Object","prototype","hasOwnProperty","call","error","lifespan","timeout","clearTimeout","setTimeout","remove","response","promise","index","indexOf","splice","then","catch","push","query","INITIAL_FILTERS","search","stringifyFilters","filters","JSON","stringify","toLowerCase","trim","initialQueries","parse","Filters","setQueries","setFilters","useState","search$","useMemo","Subject","useEffect","subscription","pipe","map","distinctUntilChanged","debounceTime","subscribe","queries","unsubscribe","next","React","type","value","onChange","useCallback","target","Button","title","onPress","rest","_extends","onClick","Link","href","e","preventDefault","undefined","Text","View","Player","uri","loop","meta","onEnded","playing","setPlaying","ref","useRef","audio","current","onPlay","console","log","onPause","addEventListener","removeEventListener","navigator","mediaSession","metadata","MediaMetadata","async","pause","play","disabled","src","autoPlay","controls","duration","currentTime","Loading","Data","data","expanded","initialExpanded","setExpanded","API_URL","Playlist","version","selected","setSelected","setLoop","setHref","setMeta","fetch","json","handleSelect","id","checked","concat","filter","item","list","name","encodeURIComponent","handlePlay","album","artists","artwork","assign","artist","join","URL","document","location","origin","toString","find","handleEnded","filtered","toLocaleLowerCase","includes","picture","key","style","display","flexDirection","padding","alignItems","background","width","height","Audio","Suspense","fallback"],"sourceRoot":""}