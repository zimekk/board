"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[50],{14050:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(92588),a=n.n(r),l=n(22155),i=n(38703);const s=i.z.object({live:i.z.record(i.z.object({publisher:i.z.object({app:i.z.string(),stream:i.z.string(),clientId:i.z.string(),connectCreated:i.z.string(),bytes:i.z.number(),ip:i.z.string(),audio:i.z.object({codec:i.z.string(),profile:i.z.string(),samplerate:i.z.number(),channels:i.z.number()}).nullable(),video:i.z.object({codec:i.z.string(),width:i.z.number(),height:i.z.number(),profile:i.z.string(),level:i.z.number(),fps:i.z.number()})}),subscribers:i.z.array(i.z.unknown())})).optional()}),o=(({protocol:e,hostname:t})=>`${e}//${t}:7000`)(new URL(window.location.href));function c({stream:e}){const[t,n]=(0,l.useState)(null),r=(0,l.useRef)();return(0,l.useEffect)((()=>{if(a().isSupported()){const t=r.current,l=a().createPlayer({type:"flv",url:e});l.attachMediaElement(t),l.on(a().Events.ERROR,n),l.load()}}),[e]),l.createElement("div",null,l.createElement("video",{ref:r,width:"480",height:"270",autoPlay:!0,controls:!0}),t&&l.createElement("pre",{style:{background:"crimson",color:"white",margin:".5em",padding:"1em"}},JSON.stringify(t)))}function m({stream:e}){return l.createElement("div",null,l.createElement("video",{crossOrigin:"anonymous",src:e,width:"480",height:"270",autoPlay:!0,controls:!0}))}function u(){const[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)(null);(0,l.useEffect)((()=>{(window?Promise.resolve({live:{NZXT:{}}}):fetch(`${o}/api/streams`,{headers:{Authorization:`Basic ${btoa(["admin","admin"].join(":"))}`}}).then((e=>e.json())).then(s.parseAsync)).then((e=>Object.keys(e.live||{}).map((e=>`${o}/live/${e}.flv`)))).then((e=>e.length>0&&(t(e),r(e[0]))))}),[]);const a=(0,l.useCallback)((({target:e})=>r(e.value)),[]);return l.createElement("section",null,l.createElement("h2",null,"Stream"),n&&e&&l.createElement("select",{value:n,onChange:a},e.map((e=>l.createElement("option",{key:e,value:e},e)))),n&&l.createElement(c,{stream:n}),l.createElement("a",{href:`${o}/admin/streams`,target:"_blank"},"streams"),l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},"~ $ git clone https://github.com/illuspas/Node-Media-Server\n\n~/Node-Media-Server $ docker build . -t nms\n~/Node-Media-Server $ docker run --name nms -d -p 1935:1935 -p 7000:8000 -p 8443:8443 nms\n"),n&&l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},`ffmpeg -stream_loop -1 -re -i share/library/BilaShsQphM.mp4 -c copy -f flv ${i=new URL(n),`rtmp://${i.hostname}${i.pathname.split(".")[0]}`}\n`),l.createElement("h2",null,"MJPEGStream"),l.createElement(m,{stream:"//192.168.2.23:8080/feed.mjpg"}),l.createElement("pre",{style:{background:"linen",margin:".5em",padding:"1em"}},'gphoto2 --set-config viewfinder=1\ngphoto2 --capture-movie --stdout | ffmpeg -re -i pipe:0 -pix_fmt yuv420p -s:v 1920x1080 -listen 1 -headers "Access-Control-Allow-Origin: *" -f mjpeg http://192.168.2.23:8080/feed.mjpg\n'));var i}}}]);
//# sourceMappingURL=50.js.map